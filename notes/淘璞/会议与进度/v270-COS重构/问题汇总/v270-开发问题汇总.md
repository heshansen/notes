# v270-开发问题汇总

### 第一周(2.26-3.2)

### 第二周(3.5-3.9)

* 问题1：
	* 问题描述：原有系统中，筛选大礼包的方法是使用SQL语句。现有系统生态圈服务无法获得赠品的详细信息，赠品的详细信息在促销服务中，故当前系统无法使用原有方法筛选数据；
	* 归类：服务接口联调问题
	* 解决方案：将筛选放在代码中进行，先连接促销服务获取当前所有可领取的赠品详细信息，再与筛选条件相比较，符合则保留在列表中，不符合则从列表中删除。遍历所有，返回最终数据；
* 问题2：
	* 问题描述：会员注册放哪个服务？
	* 归类：技术实现问题
	* 解决方案：登录接口放认证服务，先判断用户是否注册，如果注册，直接登录；如果没有注册，调会员服务的注册接口。所以，会员注册是会员服务提供的一个独立的接口。
* 问题3：
	* 问题描述：促销服务，上期版本服务命名和接口路由命名不合理，是否需要重新命名？
	* 归类：技术实现问题
	* 讨论结果：原来的服务命名和接口路由命名保持不变，新增接口路由命名采用新的分层结构；

### 第三周

* 影响项目大局的问题：
	* 描述：新架构下产生的大量内部接口联调的问题；
	* 说明：整体开发规划中只整理和评估了看得见的对外接口，并没有充足的时间详细评估对内的接口；现在随着接口开发的深入和新架构的应用，对内接口数量呈直线上升；目前只整理出部分，具体多少需要深入到每个接口的算法逻辑细节中，现在根本没时间进行精确统计；
	* 办法：
		* 1.加班，但估计再怎么加班也无法在以前的规划时间内完成，这已经是项目的体量和复杂度的升级。
		* 2.接口联调策略：等整体规划中对外的接口开发完成，再集中精力进行接口联调；增加一个对内接口联调阶段；
		* 3.最坏打算：缩短集成测试时间或延长项目整体时间。初见端倪，需做心里准备。


* 新增接口联调需求：
	* 位置：结算页和购物车列表页；
	* 需求：根据门店id查门店促销信息；
	* 老系统参考：PromotionServiceImpl.java类的getModelByBrandshop(Long brandshopSeq) 方法；
* 门票类商品立即购买时，新增出行人证件类型信息
	* 位置：结算页
	* 需求：根据商品ｉｄ查出行人证件类型信息
	* 老系统参考：CustomizationProdInfoServiceImpl的getInfoList方法。
* 门票类商品立即购买时，获得上次填写的出行人信息
	* 位置：结算页
	* 需求：根据会员ｉｄ查上次填写的出行人信息
	* 老系统参考：MemberTravelPersonServiceImpl的getModel(params)方法。

### 第四周

* 促销服务--检测会员优惠券是否已经被使用过接口；
	* 输入参数：会员id（memberSeq）、优惠券编码数组（couponList）
	* 期望输出：true,使用过；false，没有被使用过；
	* 参考：PaymentServiceImpl.java的createOrderForMember方法，第445行的“memberCouponAccountService.getList(params)”
	* 说明：不管有几个使用过，输出都是true；

### 第五周

* 订单支付接口
	* 输入参数：支付结果-payResult(0-支付失败、且返回数据验证成功;1-支付成功、且返回数据验证成功;2-返回数据验证不成功、或者数据不正常)；订单编号-orderId；支付渠道-channel（微信-wechat，支付宝-alipay，银联-chinaunion）;交易号-tradeId(微信-transaction_id,支付宝-trade_no，银联-queryId)；手续费-feeAmount（支付宝-total_fee；其他不知道或空的默认设为0）
	* 输出：MessageDTO